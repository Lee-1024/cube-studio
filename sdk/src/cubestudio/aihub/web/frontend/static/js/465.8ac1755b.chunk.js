"use strict";(self.webpackChunkcbapp_frontend=self.webpackChunkcbapp_frontend||[]).push([[465],{81465:function(e,n,t){t.d(n,{a:function(){return V},Z:function(){return L}});var a=t(44925),r=t(4942),i=t(1413),l=t(93433),o=t(29439),s=t(88977),c=t(10007),u=t(97709),d=t(73031),f=t(12513),m=t(2e4),h=t(75262),p=t(4519),g=t(43077),x=t.n(g),Z=t(74860),v=t(20558),j=t(7517),b=t(2556);function y(e){var n,t=Math.random().toString(36).substring(2),a=(0,p.useState)(e.options||[]),r=(0,o.Z)(a,2),i=r[0],l=r[1],s=(0,p.useState)(e.value||""),u=(0,o.Z)(s,2),d=u[0],f=u[1];(0,p.useEffect)((function(){var n=e.isOpenSearchMatch?(e.options||[]).filter((function(e){return-1!==e.indexOf(d)})):e.options||[];l(n)}),[e.options]),(0,p.useEffect)((function(){f(e.value||"")}),[e.value]);var m=function(n){f(n),e.onChange&&e.onChange(n)},h=function(e){var n=d,t=e.indexOf(d);if(-1===t)return(0,b.jsx)("span",{children:e});var a=e.substring(0,t),r=e.substring(t+d.length);return(0,b.jsxs)("span",{children:[a,(0,b.jsx)("span",{className:"highlight",children:n}),r]})},g=function(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];clearTimeout(n),n=setTimeout((function(){e&&e.apply(null,[].concat(r))}),t)}}(e.onScrollButtom);return(0,b.jsxs)("div",{className:"select-down-modern",children:[e.labelName?(0,b.jsx)("label",{htmlFor:t,className:"pb4 mb0 fs12 d-b",children:e.labelName}):null,(0,b.jsxs)("div",{className:"p-r d-f ac",style:{width:e.width||"100%"},children:[(0,b.jsx)(c.Z,{style:{width:"100%"},disabled:e.disabled,id:t,placeholder:e.placeholder||"",maxLength:e.maxLength||200,onChange:function(e){return m(e.target.value)},onKeyPress:function(t){13===t.nativeEvent.keyCode&&(n.blur&&n.blur(),e.onSearch&&e.onSearch(t.currentTarget.value))},value:d,ref:function(e){return n=e}}),(0,b.jsx)(j.Z,{className:"p-a r0 mr8"})]}),i.length?(0,b.jsxs)("ul",{className:"select-option shadow",onScroll:function(n){n.stopPropagation();var t=n.currentTarget,a=t.scrollTop,r=t.clientHeight;t.scrollHeight-r-a<20&&e.onScrollButtom&&g()},style:{maxHeight:"".concat(e.maxHeight,"px")},children:[e.loading?(0,b.jsx)("div",{className:"p-s z9 ta-r",style:{right:"".concat(0,"px"),top:"".concat(0,"px")},children:(0,b.jsx)("div",{className:"d-il p-a",style:{right:"".concat(8,"px"),top:"".concat(0,"px")}})}):null,i.map((function(n,t){return(0,b.jsx)("li",{className:"ellip1",onMouseDown:function(){return function(n){m(n),e.onClick&&e.onClick(n)}(n)},children:h(n)},t)}))]}):null]})}var C=t(3571),S=t(10089),N=t(96903);function _(e){var n=(0,p.useState)(!1),t=(0,o.Z)(n,2),a=(t[0],t[1],(0,p.useState)(!1)),r=(0,o.Z)(a,2),i=(r[0],r[1]),s=(0,p.useState)(""),c=(0,o.Z)(s,2),u=(c[0],c[1],(0,p.useState)([])),d=(0,o.Z)(u,2),f=(d[0],d[1],(0,p.useState)(!0)),m=(0,o.Z)(f,2),h=(m[0],m[1],(0,p.useState)([])),g=(0,o.Z)(h,2),x=g[0],Z=g[1];return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(N.Z.Dragger,{fileList:x,customRequest:function(n){console.log(n.file);var t=[].concat((0,l.Z)(x),[n.file]);Z(t),e.onChange&&e.onChange(t)},beforeUpload:function(e){var n="image/jpeg"===e.type||"image/png"===e.type;n||S.ZP.error("\u4ec5\u652f\u6301 JPG/PNG \u683c\u5f0f\u56fe\u7247");var t=e.size/1024/1024<2;return t||S.ZP.error("\u56fe\u7247\u5927\u5c0f\u5e94\u5c0f\u4e8e 2MB"),n&&t},onChange:function(n){if(console.log(n),"uploading"!==n.file.status)return"done"===n.file.status&&(i(!1),Z(n.fileList),e.onChange&&e.onChange(n.fileList)),"removed"===n.file.status?(Z(n.fileList),void(e.onChange&&e.onChange(n.fileList))):void 0;i(!0)},children:[(0,b.jsx)("p",{className:"ant-upload-drag-icon",children:(0,b.jsx)(C.Z,{})}),(0,b.jsx)("p",{className:"ant-upload-text",children:"\u70b9\u51fb\u6216\u62d6\u62fd\u6587\u4ef6\u4e0a\u4f20"})]})})}var k=t(31662),F=t(32064);function w(e){var n=(0,p.useState)(!1),t=(0,o.Z)(n,2),a=(t[0],t[1],(0,p.useState)(!1)),r=(0,o.Z)(a,2),i=r[0],s=r[1],c=(0,p.useState)(""),u=(0,o.Z)(c,2),d=(u[0],u[1],(0,p.useState)([])),f=(0,o.Z)(d,2),m=f[0],h=f[1],g=(0,p.useState)(!0),x=(0,o.Z)(g,2);x[0],x[1];return(0,b.jsxs)("div",{className:"d-f fw",children:[m.map((function(n,t){var a=Math.random().toString(36).substring(2);return(0,b.jsxs)("div",{className:"image-card s0 mr16 mb16",children:[(0,b.jsx)("div",{className:"image-close",onClick:function(){var n=(0,l.Z)(m);n.splice(t,1),h(n),e.onChange&&e.onChange(n)},children:(0,b.jsx)(k.Z,{style:{color:"#fff"}})}),(0,b.jsx)("img",{src:n,alt:"file",style:{width:"100%"}})]},a)})),m.length<(e.maxCount||1)?(0,b.jsx)(N.Z,{name:"file",listType:"picture-card",className:"file-uploader",showUploadList:!1,method:"POST",customRequest:function(n){console.log(n.file),function(e,n){var t=new FileReader;t.addEventListener("load",(function(){return n(t.result)})),t.readAsDataURL(e)}(n.file,(function(n){var t=[].concat((0,l.Z)(m),[n]);h(t),s(!1),e.onChange&&e.onChange(t)}))},beforeUpload:function(e){var n="image/jpeg"===e.type||"image/png"===e.type;n||S.ZP.error("\u4ec5\u652f\u6301 JPG/PNG \u683c\u5f0f\u56fe\u7247");var t=e.size/1024/1024<2;return t||S.ZP.error("\u56fe\u7247\u5927\u5c0f\u5e94\u5c0f\u4e8e 2MB"),n&&t},onChange:function(e){console.log(e),"uploading"!==e.file.status?"done"===e.file.status&&s(!1):s(!0)},children:(0,b.jsxs)("div",{children:[i?(0,b.jsx)(F.Z,{}):(0,b.jsx)(v.Z,{}),(0,b.jsx)("div",{style:{marginTop:8},children:"\u4e0a\u4f20\u56fe\u7247"})]})}):null]})}var I=["key","name"];function V(e){return e.reduce((function(e,n){return e+(n||"").split("").reduce((function(e,n){return e+n.charCodeAt(0)}),0)}),0)}function L(e){var n=(0,p.useState)(0),t=(0,o.Z)(n,2),g=t[0],j=t[1],C=(0,p.useState)(e.config),S=(0,o.Z)(C,2),N=S[0],k=S[1],F=(0,p.useRef)(e.config),L=function(e){F.current=e,k(e)},T=(0,p.useState)(e.configGroup),P=(0,o.Z)(T,2),M=P[0],R=P[1],H=(0,p.useRef)(e.configGroup),O=function(e){H.current=e,R(e)},G=function(n,t){var a=function(n,t){return t.filter((function(e){return e.dep.includes(n)})).map((function(n){var t=V(n.dep.map((function(n){var t;return null===(t=e.form)||void 0===t?void 0:t.getFieldValue(n)})).filter((function(e){return!(void 0===e||null===e)})));return{effect:n.effect,option:n.effectOption[t]||[]}}))}(n,t);a.forEach((function(n){var t;null===(t=e.form)||void 0===t||t.setFieldsValue((0,r.Z)({},n.effect,void 0)),function(e,n){var t=F.current?(0,l.Z)(F.current):[];if(t)for(var a=0;a<t.length;a++){var r=t[a];r.name===e&&(t[a]=(0,i.Z)((0,i.Z)({},r),n))}L(t)}(n.effect,{options:n.option}),function(e,n){for(var t=H.current?(0,l.Z)(H.current):[],a=0;a<t.length;a++){for(var r=(0,l.Z)(t[a].config),o=0;o<r.length;o++){var s=r[o];s.name===e&&(r[o]=(0,i.Z)((0,i.Z)({},s),n))}t[a]=(0,i.Z)((0,i.Z)({},t[a]),{},{config:r})}O(t)}(n.effect,{options:n.option})}))};(0,p.useEffect)((function(){if(e.formChangeRes&&e.linkageConfig){var n=e.formChangeRes.currentChange;G(Object.keys(n)[0],e.linkageConfig)}}),[e.formChangeRes]),(0,p.useEffect)((function(){var n;L(e.config),O(e.configGroup);var t=(null===(n=e.form)||void 0===n?void 0:n.getFieldsValue())||{};Object.entries(t).forEach((function(n){var t=(0,o.Z)(n,2),a=t[0];void 0!==t[1]&&G(a,e.linkageConfig||[])}))}),[e.configGroup,e.config]);var E=function(){j(g+1)},D=function(e,n){return(0,b.jsx)(s.Z.Item,(0,i.Z)((0,i.Z)({label:e.label,name:e.name,rules:e.rules,initialValue:e.defaultValue,extra:e.description?(0,b.jsx)("span",{dangerouslySetInnerHTML:{__html:e.description}}):null},n),{},{children:(0,b.jsx)(w,{})}),"dynamicForm_".concat(e.name))},z=function(e,n){return(0,b.jsx)(s.Z.Item,(0,i.Z)((0,i.Z)({label:e.label,name:e.name,rules:e.rules,initialValue:e.defaultValue,extra:e.description?(0,b.jsx)("span",{dangerouslySetInnerHTML:{__html:e.description}}):null},n),{},{children:(0,b.jsx)(_,{})}),"dynamicForm_".concat(e.name))},U=function(e,n){return(0,b.jsx)(s.Z.Item,(0,i.Z)((0,i.Z)({label:e.label,name:e.name,rules:e.rules,initialValue:e.defaultValue,extra:e.description?(0,b.jsx)("span",{dangerouslySetInnerHTML:{__html:e.description}}):null},n),{},{children:(0,b.jsx)(c.Z,{disabled:e.disable,placeholder:"\u8bf7\u8f93\u5165".concat(e.label)})}),"dynamicForm_".concat(e.name))},A=function(e,n){var t=(e.options||[]).map((function(e){return e.label}));return(0,b.jsx)(s.Z.Item,(0,i.Z)((0,i.Z)({label:e.label,name:e.name,rules:e.rules,initialValue:e.defaultValue,extra:e.description?(0,b.jsx)("span",{dangerouslySetInnerHTML:{__html:e.description}}):null},n),{},{children:(0,b.jsx)(y,{isOpenSearchMatch:!0,disabled:e.disable,placeholder:"\u8bf7\u9009\u62e9".concat(e.label),options:t})}),"dynamicForm_".concat(e.name))},q=function(e,n){return(0,b.jsx)(s.Z.Item,(0,i.Z)((0,i.Z)({label:e.label,name:e.name,rules:e.rules,initialValue:e.defaultValue,extra:e.description?(0,b.jsx)("span",{dangerouslySetInnerHTML:{__html:e.description}}):null},n),{},{children:(0,b.jsx)(c.Z.TextArea,{autoSize:{minRows:4},disabled:e.disable,placeholder:"\u8bf7\u8f93\u5165".concat(e.label)})}),"dynamicForm_".concat(e.name))},B=function(n,t){var a=n.options||[];return(0,b.jsx)(s.Z.Item,(0,i.Z)((0,i.Z)({label:n.label,name:n.name,rules:n.rules,initialValue:n.defaultValue,extra:n.description?(0,b.jsx)("span",{dangerouslySetInnerHTML:{__html:n.description}}):null},t),{},{children:(0,b.jsx)(h.Z,{onClick:function(){var n;console.log("click",null===(n=e.form)||void 0===n?void 0:n.getFieldsValue())},style:{width:"100%"},mode:n.multiple?"multiple":void 0,onChange:function(t){n.data.retry_info&&e.onRetryInfoChange&&e.onRetryInfoChange(t)},showSearch:!0,disabled:n.disable,optionFilterProp:"label",placeholder:"\u8bf7\u9009\u62e9".concat(n.label),options:a})}),"dynamicForm_".concat(n.name))},J=function(e,n){var t=e.options||[];return(0,b.jsx)(s.Z.Item,(0,i.Z)((0,i.Z)({label:e.label,name:e.name,rules:e.rules,initialValue:e.defaultValue},n),{},{children:(0,b.jsx)(u.ZP.Group,{options:t})}),"dynamicForm_".concat(e.name))},K=function(e,n){return(0,b.jsx)(s.Z.Item,(0,i.Z)((0,i.Z)({label:e.label,name:"fromDate",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u65f6\u95f4"}]},n),{},{children:(0,b.jsx)(d.Z,{showTime:!0,disabledDate:function(e){return e&&e>x()().endOf("day")}})}),"dynamicForm_".concat(e.name))},Q=function(e,n){return(0,b.jsx)(s.Z.Item,(0,i.Z)((0,i.Z)({label:e.label,name:"fromDate",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u65f6\u95f4"}]},n),{},{children:(0,b.jsx)(d.Z,{showTime:!0,disabledDate:function(e){return e&&e>x()().endOf("day")}})}),"dynamicForm_".concat(e.name))},W=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e.type){case"imageUpload":return D(e,n);case"fileUpload":return z(e,n);case"input":case"match-input":return U(e,n);case"input-select":return A(e,n);case"textArea":return q(e,n);case"select":return B(e,n);case"datePicker":return K(e,n);case"rangePicker":return Q(e,n);case"radio":return J(e,n);default:return null}},X=function(e){return(e||[]).map((function(e){return e.list&&e.list.length?(0,b.jsx)(s.Z.List,{name:e.name,children:function(n,t){var r=t.add,l=t.remove;return(0,b.jsxs)(b.Fragment,{children:[n.map((function(n){var t=n.key,r=n.name,o=(0,a.Z)(n,I);return(0,b.jsxs)("div",{className:"bor b-side pt32 plr16 mb16",children:[e.list&&e.list.map((function(e){return W(e,(0,i.Z)((0,i.Z)({},o),{},{name:[r,e.name]}))})),(0,b.jsx)(s.Z.Item,{wrapperCol:{offset:5},children:(0,b.jsx)(f.Z,{danger:!0,onClick:function(){return l(r)},block:!0,icon:(0,b.jsx)(Z.Z,{}),children:"\u5220\u9664\u8be5\u9879"})})]},t)})),(0,b.jsx)(s.Z.Item,{noStyle:!0,className:"w100",children:(0,b.jsx)(f.Z,{type:"dashed",className:"w100",onClick:function(){return r()},block:!0,icon:(0,b.jsx)(v.Z,{}),children:"\u589e\u52a0\u4e00\u9879"})})]})}},"dynamicForm_".concat(e.name)):W(e)}))};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Z.Item,{name:e.primaryKey||"id",noStyle:!0,hidden:!0,children:(0,b.jsx)(c.Z,{})},"dynamicForm_id"),M&&M.length?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.Z,{current:g,children:(M||[]).map((function(e,n){return(0,b.jsx)(m.Z.Step,{title:e.group},n)}))}),(0,b.jsx)("div",{className:"pt32",children:(M||[]).map((function(e,n){return(0,b.jsx)("div",{className:[g===n?"p-r z9":"p-a z-99 v-h l-10000"].join(" "),children:X(e.config)},n)}))}),(0,b.jsxs)("div",{className:"ta-c pt32",children:[g>0&&(0,b.jsx)(f.Z,{onClick:function(){j(g-1)},children:"\u4e0a\u4e00\u6b65"}),g<(M||[]).length-1&&(0,b.jsx)(f.Z,{type:"primary",className:"ml16",onClick:function(){if(e.form){var n=M[g].config.map((function(e){return e.name}));e.form.validateFields(n).then((function(){E()})).catch((function(e){console.log(e)}))}else E()},children:"\u4e0b\u4e00\u6b65"}),(0,b.jsx)("div",{children:g===(M||[]).length-1&&(0,b.jsx)("div",{className:"pt8 c-hint-b",children:"\u70b9\u51fb\u786e\u5b9a\u5b8c\u6210\u63d0\u4ea4"})})]})]}):X(N||[])]})}}}]);
//# sourceMappingURL=465.8ac1755b.chunk.js.map